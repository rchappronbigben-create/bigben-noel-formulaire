<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>üéÑ Tirage au sort No√´l ‚Äî Bigben Connected</title>

<style>
:root{
  --bb-red:#b8001f;
  --bb-white:#ffffff;
  --bb-gold:#d4af37;
  --bb-text:#111;
}
body{
  margin:0;
  font-family:"Segoe UI",Roboto,Arial,sans-serif;
  background:linear-gradient(180deg,var(--bb-red) 0%,var(--bb-white) 100%);
  color:var(--bb-text);
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:40px 10px 80px;
}
.card{
  background:#fff;
  border:3px solid var(--bb-gold);
  border-radius:18px;
  box-shadow:0 8px 30px rgba(0,0,0,.2);
  max-width:720px;
  width:100%;
  padding:32px;
}
header{text-align:center;margin-bottom:10px;}
.logo{width:180px;}
h1{font-size:1.7rem;color:var(--bb-red);}
.subtitle{margin-top:4px;font-weight:600;color:#444}
.grid{display:grid;gap:14px;grid-template-columns:1fr 1fr;}
.full{grid-column:1/-1;}
label{display:block;font-weight:600;margin-bottom:4px;}
input,select{
  width:100%;padding:10px 12px;border:1px solid #ccc;border-radius:8px;font-size:15px;
}
button{
  margin-top:8px;padding:13px 24px;background:var(--bb-red);
  color:#fff;font-weight:700;border:none;border-radius:10px;font-size:16px;
  box-shadow:0 8px 20px rgba(0,0,0,.2);cursor:pointer;
}
button:hover{background:#8d0018;}
.resume{
  font-size:13px;margin-top:20px;line-height:1.45;color:#333;
  background:#fff7eb;border:1px dashed var(--bb-gold);
  padding:15px;border-radius:12px;
}
@media(max-width:640px){.grid{grid-template-columns:1fr;}}
</style>
</head>

<body>
<div class="card">

<header>
  <img src="BIGBEN.png" class="logo">
  <h1>üéÑ Tirage au sort No√´l ‚Äî Bigben Connected</h1>
  <p class="subtitle"><strong>Participation du 1 au 20 d√©cembre 2025</strong></p>
</header>

<form id="jeuForm" novalidate>
  <div class="grid">

    <div>
      <label for="nom">Nom</label>
      <input id="nom" name="nom" type="text" required>
    </div>

    <div>
      <label for="prenom">Pr√©nom</label>
      <input id="prenom" name="prenom" type="text" required>
    </div>

    <div>
      <label for="naissance">Date de naissance</label>
      <input id="naissance" name="naissance" type="date" required>
    </div>

    <div class="full">
      <label for="email">E-mail</label>
      <input id="email" name="email" type="email" required>
    </div>

    <div>
      <label for="tel">T√©l√©phone</label>
      <input id="tel" name="tel" type="tel" required>
    </div>

    <div class="full">
      <label for="magasin">Magasin</label>
      <select id="magasin" name="magasin" required>
        <option value="">-- S√©lectionnez votre magasin --</option>
        <option value="Leclerc Bourgoin-Jallieu">Leclerc Bourgoin-Jallieu</option>
      </select>
    </div>

    <div>
      <label for="montant">Montant d‚Äôachat Bigben (‚Ç¨)</label>
      <input id="montant" name="montant" type="number" min="20" required>
    </div>

    <div>
      <label for="date">Date d‚Äôachat</label>
      <input id="date" name="date" type="date" min="2025-12-01" max="2025-12-20" required>
    </div>

    <div class="full">
      <label for="ticket">Photo du ticket</label>
      <input id="ticket" name="ticket" type="file" accept=".jpg,.jpeg,.png,.pdf" required>
    </div>

    <div class="full">
      <label>
        <input type="checkbox" id="accept_reglement" name="accept_reglement" required>
        En soumettant ce formulaire, j‚Äôaccepte le r√®glement du jeu :
        <a href="reglement.html" target="_blank">Lire le r√®glement</a>.
      </label>
    </div>

    <div class="full">
      <label><input type="checkbox" id="newsletter" name="newsletter"> Je souhaite recevoir les newsletters Bigben.</label>
    </div>

  </div>

  <button type="submit">Envoyer ma participation</button>
</form>

<div class="resume">
  <strong style="font-size:15px;">INFORMATIONS R√âSUM√âES :</strong><br><br>

  <p><strong>üìÖ Jeu ouvert du 1 au 20 d√©cembre 2025</strong><br>
  Tirage au sort le <strong>22 d√©cembre 2025</strong>.</p>

  <p><strong>üéÅ Lots √† gagner :</strong><br>
  ‚Ä¢ Montre ICE Smart TKS 2.0 ‚Äî 169‚Ç¨ TTC<br>
  ‚Ä¢ Enceinte Bluetooth ‚Äî 99‚Ç¨ TTC<br>
  ‚Ä¢ √âcouteurs Play Touch XL ‚Äî 49‚Ç¨ TTC</p>

  <p><strong>üßæ Participation :</strong><br>
  Achat de <strong>2 produits Bigben / Bigben Connected / Force</strong> + envoi du ticket de caisse via le formulaire.</p>

  <p><strong>üìú R√®glement complet :</strong><br>
  <a href="reglement.html" target="_blank"><strong>Lire le r√®glement officiel</strong></a></p>
</div>

</div>

<script>
/* üöÄ URL APPS SCRIPT */
const FLOW_URL = "https://script.google.com/macros/s/AKfycbwF2P5gYesdlkiC_d6VMadKliDJN3XubA5qRn1khcuQvVK7kr1t4KVRd7WvK4Og7Nlu/exec";
const THANKS_URL = "merci.html";

const f = id => document.getElementById(id);

/* V√©rification r√®glement */
function valid() {
  if (!f("accept_reglement").checked) {
    alert("Vous devez accepter le r√®glement.");
    return false;
  }
  return true;
}

/* Conversion fichier ‚Üí Base64 */
async function fileToBase64(file){
  return new Promise((resolve, reject)=>{
    const reader = new FileReader();
    reader.onload = ()=> resolve(reader.result.split(",")[1]);
    reader.onerror = ()=> reject("Erreur lecture fichier");
    reader.readAsDataURL(file);
  });
}

/* Envoi formulaire */
document.getElementById("jeuForm").addEventListener("submit", async(e)=>{
  e.preventDefault();
  if(!valid()) return;

  const file = f("ticket").files[0];
  if (!file){
    alert("Merci d‚Äôajouter votre ticket.");
    return;
  }

  let base64 = await fileToBase64(file);

  const data = {
    nom_famille: f("nom").value.trim(),
    prenom: f("prenom").value.trim(),
    date_naissance: f("naissance").value,
    email: f("email").value.trim(),
    telephone: f("tel").value.trim(),
    magasin: f("magasin").value,
    montant_eur: Number(f("montant").value),
    date_achat: f("date").value,
    consentement_jeu:"oui",
    consentement_rgpd:"oui",
    newsletter: f("newsletter").checked ? "oui" : "non",
    meta: { ts_iso: new Date().toISOString() },
    ticket:{
      filename:file.name,
      mimetype:file.type,
      base64
    }
  };

  try{
    await fetch(FLOW_URL, {
  method: "POST",
  mode: "no-cors",
  body: JSON.stringify(data)
});

  }catch(err){
    alert("Erreur d'envoi : "+err);
    return;
  }

  window.location.href = THANKS_URL;
});
</script>

</body>
</html>




